#!/usr/bin/env bash
set -e
case $1 in
  exit) {
    [ -n "$2" ] || mcd --fail "mcd-cdp: Please specify a gem amount"
    join=$(mcd gem adapter)
    wad=$(seth --to-uint256 $(seth --to-hex $(seth --to-wei "$2 eth")))
    sig="exit(address,uint)"
    bytes=$(seth calldata $sig $ETH_FROM $wad)
    proxy=$(mcd --proxy-address)
    echo $proxy
    seth send $proxy 'execute(address,bytes memory)' ${MCD_VAT?} $bytes
    [[ $SETH_ASYNC != yes ]] && time mcd gem balance
  };;
  *) {
    mcd gem "$@";
  };;
esac
